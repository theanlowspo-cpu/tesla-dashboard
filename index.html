<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>J.A.R.V.I.S. Tesla è‡ªå‹•æŠ„åº•ç³»çµ±</title>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Noto Sans TC', sans-serif; background: #0a0a0a; color: #fff; min-height: 100vh; overflow-x: hidden; }
        .bg-layer { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }
        .bg-layer img { width: 100%; height: 100%; object-fit: cover; opacity: 0.3; }
        .bg-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(135deg, rgba(0,0,0,0.9) 0%, rgba(20,0,0,0.8) 50%, rgba(0,0,0,0.9) 100%); z-index: -1; }
        .header { padding: 20px 40px; display: flex; justify-content: space-between; align-items: center; border-bottom: 1px solid rgba(232,33,39,0.3); backdrop-filter: blur(10px); background: rgba(0,0,0,0.5); }
        .logo { display: flex; align-items: center; gap: 15px; }
        .logo img { width: 60px; height: 60px; border-radius: 50%; border: 2px solid #e82127; box-shadow: 0 0 20px rgba(232,33,39,0.5); }
        .logo-text { font-family: 'Orbitron', sans-serif; }
        .logo-text h1 { font-size: 1.8rem; background: linear-gradient(90deg, #e82127, #ff6b6b); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .logo-text span { font-size: 0.8rem; color: #888; letter-spacing: 3px; }
        .header-right { display: flex; align-items: center; gap: 15px; }
        .status-badge { display: flex; align-items: center; gap: 10px; padding: 10px 20px; background: rgba(0,255,0,0.1); border: 1px solid rgba(0,255,0,0.3); border-radius: 30px; }
        .status-dot { width: 12px; height: 12px; background: #00ff00; border-radius: 50%; animation: pulse 2s infinite; }
        .refresh-btn { background: rgba(232,33,39,0.2); border: 1px solid #e82127; color: #e82127; padding: 10px 20px; border-radius: 30px; cursor: pointer; font-family: 'Orbitron', sans-serif; font-size: 0.8rem; transition: all 0.3s ease; }
        .refresh-btn:hover { background: #e82127; color: #fff; }
        @keyframes pulse { 0%, 100% { box-shadow: 0 0 5px #00ff00; } 50% { box-shadow: 0 0 20px #00ff00, 0 0 40px #00ff00; } }
        .main-content { display: grid; grid-template-columns: 1fr 400px; gap: 30px; padding: 40px; max-width: 1600px; margin: 0 auto; }
        .main-panel { display: flex; flex-direction: column; gap: 30px; }
        .stock-card { background: linear-gradient(145deg, rgba(20,20,20,0.9), rgba(10,10,10,0.95)); border: 1px solid rgba(232,33,39,0.3); border-radius: 20px; padding: 30px; position: relative; overflow: hidden; }
        .stock-card::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, transparent, #e82127, transparent); }
        .stock-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 30px; }
        .stock-info h2 { font-family: 'Orbitron', sans-serif; font-size: 3rem; color: #e82127; text-shadow: 0 0 30px rgba(232,33,39,0.5); }
        .stock-info p { color: #888; font-size: 1.1rem; }
        .stock-price { text-align: right; }
        .price-value { font-family: 'Orbitron', sans-serif; font-size: 3.5rem; font-weight: 900; background: linear-gradient(90deg, #00ff88, #00ffcc); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .price-change { font-size: 1.5rem; padding: 5px 15px; border-radius: 10px; display: inline-block; margin-top: 10px; }
        .price-change.up { background: rgba(0,255,0,0.2); color: #00ff00; }
        .price-change.down { background: rgba(255,0,0,0.2); color: #ff4444; }
        .strategy-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; }
        .strategy-item { background: rgba(30,30,30,0.8); border: 1px solid rgba(255,255,255,0.1); border-radius: 15px; padding: 25px; text-align: center; transition: all 0.3s ease; }
        .strategy-item:hover { border-color: #e82127; transform: translateY(-5px); box-shadow: 0 10px 30px rgba(232,33,39,0.2); }
        .strategy-item .icon { font-size: 2.5rem; margin-bottom: 15px; }
        .strategy-item .label { color: #888; font-size: 0.9rem; margin-bottom: 10px; }
        .strategy-item .value { font-family: 'Orbitron', sans-serif; font-size: 1.8rem; color: #fff; }
        .trades-section { background: linear-gradient(145deg, rgba(20,20,20,0.9), rgba(10,10,10,0.95)); border: 1px solid rgba(232,33,39,0.3); border-radius: 20px; padding: 30px; }
        .section-title { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: #e82127; margin-bottom: 20px; display: flex; align-items: center; gap: 10px; }
        .trades-list { max-height: 300px; overflow-y: auto; }
        .trade-item { display: flex; justify-content: space-between; align-items: center; padding: 15px; background: rgba(40,40,40,0.5); border-radius: 10px; margin-bottom: 10px; border-left: 3px solid; }
        .trade-item.buy { border-left-color: #00ff00; }
        .trade-item.sell { border-left-color: #e82127; }
        .trade-item.test { border-left-color: #ffa726; }
        .trade-info .type { font-weight: bold; font-size: 1.1rem; }
        .trade-info .date { color: #888; font-size: 0.85rem; }
        .trade-details { text-align: right; }
        .trade-details .price { font-family: 'Orbitron', sans-serif; font-size: 1.2rem; }
        .ai-panel { display: flex; flex-direction: column; gap: 20px; }
        .ai-card { background: linear-gradient(145deg, rgba(20,20,20,0.9), rgba(10,10,10,0.95)); border: 1px solid rgba(232,33,39,0.3); border-radius: 20px; padding: 25px; text-align: center; }
        .ai-avatar { width: 200px; height: 200px; margin: 0 auto 20px; border-radius: 50%; overflow: hidden; border: 3px solid #e82127; box-shadow: 0 0 40px rgba(232,33,39,0.4); animation: glow 3s ease-in-out infinite; }
        @keyframes glow { 0%, 100% { box-shadow: 0 0 40px rgba(232,33,39,0.4); } 50% { box-shadow: 0 0 60px rgba(232,33,39,0.6), 0 0 80px rgba(232,33,39,0.3); } }
        .ai-avatar img { width: 100%; height: 100%; object-fit: cover; }
        .ai-name { font-family: 'Orbitron', sans-serif; font-size: 1.5rem; color: #e82127; margin-bottom: 5px; }
        .ai-title { color: #888; font-size: 0.9rem; margin-bottom: 20px; }
        .ai-status { background: rgba(0,255,0,0.1); border: 1px solid rgba(0,255,0,0.3); border-radius: 10px; padding: 15px; margin-bottom: 20px; }
        .ai-status .label { color: #888; font-size: 0.8rem; }
        .ai-status .value { color: #00ff00; font-family: 'Orbitron', sans-serif; font-size: 1.2rem; }
        .update-info { background: rgba(30,30,30,0.8); border-radius: 10px; padding: 15px; margin-top: 10px; }
        .update-info .row { display: flex; justify-content: space-between; padding: 5px 0; font-size: 0.85rem; }
        .update-info .label { color: #888; }
        .update-info .value { color: #00ffcc; font-family: 'Orbitron', sans-serif; }
        .account-card { background: linear-gradient(145deg, rgba(20,20,20,0.9), rgba(10,10,10,0.95)); border: 1px solid rgba(232,33,39,0.3); border-radius: 20px; padding: 25px; }
        .account-item { display: flex; justify-content: space-between; padding: 12px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
        .account-item:last-child { border-bottom: none; }
        .account-item .label { color: #888; }
        .account-item .value { font-family: 'Orbitron', sans-serif; color: #00ffcc; }
        .rules-card { background: linear-gradient(145deg, rgba(20,20,20,0.9), rgba(10,10,10,0.95)); border: 1px solid rgba(232,33,39,0.3); border-radius: 20px; padding: 25px; }
        .rule-item { display: flex; align-items: center; gap: 10px; padding: 10px 0; font-size: 0.9rem; color: #ccc; }
        .rule-item .icon { color: #e82127; }
        .footer-image { margin-top: 20px; border-radius: 15px; overflow: hidden; border: 1px solid rgba(232,33,39,0.3); }
        .footer-image img { width: 100%; height: 150px; object-fit: cover; opacity: 0.7; }
        @media (max-width: 1200px) { .main-content { grid-template-columns: 1fr; } .ai-panel { display: grid; grid-template-columns: repeat(2, 1fr); } }
        @media (max-width: 768px) { .header { flex-direction: column; gap: 15px; padding: 15px; } .main-content { padding: 15px; } .strategy-grid { grid-template-columns: 1fr; } .ai-panel { grid-template-columns: 1fr; } .stock-info h2 { font-size: 2rem; } .price-value { font-size: 2.5rem; } }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.3); }
        ::-webkit-scrollbar-thumb { background: #e82127; border-radius: 4px; }
    </style>
</head>
<body>
    <div class="bg-layer"><img src="bg.jpg" alt="background"></div>
    <div class="bg-overlay"></div>
    <header class="header">
        <div class="logo">
            <img src="ai_robot.jpg" alt="J.A.R.V.I.S.">
            <div class="logo-text">
                <h1>J.A.R.V.I.S.</h1>
                <span>TESLA AUTO DIP-BUYING SYSTEM</span>
            </div>
        </div>
        <div class="header-right">
            <div class="status-badge">
                <div class="status-dot"></div>
                <span id="systemStatus">è‡ªå‹•æ›´æ–°ä¸­</span>
            </div>
            <button class="refresh-btn" onclick="manualRefresh()">ğŸ”„ æ‰‹å‹•åˆ·æ–°</button>
        </div>
    </header>
    <main class="main-content">
        <div class="main-panel">
            <div class="stock-card">
                <div class="stock-header">
                    <div class="stock-info"><h2>TSLA</h2><p>Tesla, Inc.</p></div>
                    <div class="stock-price">
                        <div class="price-value" id="currentPrice">$---</div>
                        <div class="price-change up" id="priceChange">+0.00%</div>
                    </div>
                </div>
                <div class="strategy-grid">
                    <div class="strategy-item"><div class="icon">ğŸ’°</div><div class="label">å¸³æˆ¶æ·¨å€¼</div><div class="value" id="accountValue">$---</div></div>
                    <div class="strategy-item"><div class="icon">ğŸ“Š</div><div class="label">æŒå€‰ç‹€æ…‹</div><div class="value" id="positionStatus">---</div></div>
                    <div class="strategy-item"><div class="icon">ğŸ¯</div><div class="label">ç¸½æ”¶ç›Šç‡</div><div class="value" id="totalReturn">---</div></div>
                    <div class="strategy-item"><div class="icon">âœ…</div><div class="label">å‹ç‡</div><div class="value" id="winRate">---</div></div>
                    <div class="strategy-item"><div class="icon">ğŸ“ˆ</div><div class="label">å®Œæˆäº¤æ˜“</div><div class="value" id="totalTrades">---</div></div>
                    <div class="strategy-item"><div class="icon">â±ï¸</div><div class="label">è‡ªå‹•æ›´æ–°</div><div class="value" id="nextCheck">30ç§’</div></div>
                </div>
            </div>
            <div class="trades-section">
                <h3 class="section-title">ğŸ“œ äº¤æ˜“æ­·å²</h3>
                <div class="market-notice" id="marketNotice" style="display:none; background: rgba(255,165,0,0.1); border: 1px solid rgba(255,165,0,0.3); border-radius: 10px; padding: 12px; margin-bottom: 15px; font-size: 0.9rem; color: #ffa726;">
                    <span>ğŸ“… </span><span id="marketNoticeText">é€±æœ«/å‡æ—¥ä¸åŸ·è¡Œäº¤æ˜“ç¨‹åº</span>
                </div>
                <div class="trades-list" id="tradesList"><div class="trade-item test"><div class="trade-info"><div class="type">ç­‰å¾…ä¸­...</div><div class="date">å°šç„¡äº¤æ˜“è¨˜éŒ„</div></div></div></div>
            </div>
        </div>
        <div class="ai-panel">
            <div class="ai-card">
                <div class="ai-avatar"><img src="ai_robot.jpg" alt="J.A.R.V.I.S."></div>
                <div class="ai-name">è³ˆç¶­æ–¯</div>
                <div class="ai-title">AI è‡ªå‹•äº¤æ˜“åŠ©æ‰‹</div>
                <div class="ai-status"><div class="label">ç•¶å‰ç‹€æ…‹</div><div class="value" id="aiStatus">ğŸ” ç›£æ§ä¸­</div></div>
                <div class="update-info">
                    <div class="row"><span class="label">æ•¸æ“šæ›´æ–°</span><span class="value" id="lastUpdate">--:--:--</span></div>
                    <div class="row"><span class="label">ä¸‹æ¬¡åˆ·æ–°</span><span class="value" id="countdown">30ç§’</span></div>
                </div>
            </div>
            <div class="account-card">
                <h3 class="section-title">ğŸ’³ å¸³æˆ¶è³‡è¨Š</h3>
                <div class="account-item"><span class="label">å¯ç”¨ç¾é‡‘</span><span class="value" id="cashBalance">$---</span></div>
                <div class="account-item"><span class="label">è³¼è²·åŠ›</span><span class="value" id="buyingPower">$---</span></div>
                <div class="account-item"><span class="label">æŒå€‰å¸‚å€¼</span><span class="value" id="positionValue">$---</span></div>
            </div>
            <div class="rules-card">
                <h3 class="section-title">ğŸ“‹ è€çˆºç‰ˆæœ¬ç­–ç•¥</h3>
                <div class="rule-item"><span class="icon">ğŸ”»</span><span>å–®æ—¥è·Œ â‰¥3% è§¸ç™¼è²·å…¥</span></div>
                <div class="rule-item"><span class="icon">1ï¸âƒ£</span><span>ç¬¬ä¸€éšæ®µï¼š30% è³‡é‡‘</span></div>
                <div class="rule-item"><span class="icon">2ï¸âƒ£</span><span>è·Œè‡³ -5%ï¼šåŠ ç¢¼ 20%</span></div>
                <div class="rule-item"><span class="icon">3ï¸âƒ£</span><span>è·Œè‡³ -8%ï¼šå…¨éƒ¨æ¢­å“ˆ</span></div>
                <div class="rule-item"><span class="icon">ğŸš«</span><span>ä¸è¨­åœæï¼Œæ­»æ‰›åˆ°åº•</span></div>
                <div class="rule-item"><span class="icon">ğŸ’°</span><span>ç²åˆ© â‰¥3% å…¨éƒ¨è³£å‡º</span></div>
            </div>
            <div class="footer-image"><img src="trading.jpg" alt="Trading"></div>
        </div>
    </main>
    <script>
        let countdown = 30;
        
        setInterval(() => {
            countdown--;
            document.getElementById('countdown').textContent = countdown + 'ç§’';
            document.getElementById('nextCheck').textContent = countdown + 'ç§’';
            if (countdown <= 0) { countdown = 30; loadData(); }
        }, 1000);
        
        function manualRefresh() {
            const btn = document.querySelector('.refresh-btn');
            btn.style.opacity = '0.5';
            btn.textContent = 'åˆ·æ–°ä¸­...';
            loadData().then(() => {
                countdown = 30;
                btn.style.opacity = '1';
                btn.textContent = 'ğŸ”„ æ‰‹å‹•åˆ·æ–°';
            });
        }
        
        async function loadData() {
            try {
                const urls = ['https://raw.githubusercontent.com/theanlowspo-cpu/tesla-dashboard/main/tesla_dashboard_data.json', 'tesla_dashboard_data.json'];
                let data = null;
                for (const url of urls) {
                    try {
                        const response = await fetch(url + '?t=' + Date.now());
                        if (response.ok) { data = await response.json(); break; }
                    } catch (e) {}
                }
                if (data) {
                    updateDashboard(data);
                    document.getElementById('lastUpdate').textContent = new Date().toLocaleTimeString('zh-TW');
                }
            } catch (e) { console.log('ç­‰å¾…æ•¸æ“š...'); }
        }
        
        function updateDashboard(data) {
            document.getElementById('currentPrice').textContent = '$' + (data.currentPrice || 0).toFixed(2);
            const changeEl = document.getElementById('priceChange');
            const change = data.dailyChange || 0;
            changeEl.textContent = (change >= 0 ? '+' : '') + change.toFixed(2) + '%';
            changeEl.className = 'price-change ' + (change >= 0 ? 'up' : 'down');
            document.getElementById('accountValue').textContent = '$' + (data.accountValue || 0).toLocaleString();
            document.getElementById('cashBalance').textContent = '$' + (data.cash || 0).toLocaleString();
            document.getElementById('buyingPower').textContent = '$' + (data.buyingPower || 0).toLocaleString();
            const hasPosition = data.position && data.position.shares > 0;
            document.getElementById('positionStatus').textContent = hasPosition ? data.position.shares + ' è‚¡' : 'ç©ºå€‰';
            document.getElementById('positionValue').textContent = hasPosition ? '$' + (data.position.shares * data.currentPrice).toLocaleString() : '$0';
            document.getElementById('totalReturn').textContent = (data.totalReturn || 0).toFixed(2) + '%';
            document.getElementById('winRate').textContent = (data.winRate || 0) + '%';
            document.getElementById('totalTrades').textContent = (data.completedTrades || 0) + ' ç­†';
            let aiStatus = data.status || (hasPosition ? 'ğŸ“ˆ æŒå€‰ä¸­' : (change <= -3 ? 'ğŸ”¥ è²·å…¥æ©Ÿæœƒï¼' : 'ğŸ” ç›£æ§ä¸­'));
            document.getElementById('aiStatus').textContent = aiStatus;
            if (data.note) document.getElementById('systemStatus').textContent = data.note;
            
            // é¡¯ç¤ºå‡æ—¥/é€±æœ«æç¤º
            const marketNotice = document.getElementById('marketNotice');
            const marketNoticeText = document.getElementById('marketNoticeText');
            if (data.isMarketClosed) {
                marketNotice.style.display = 'block';
                marketNoticeText.textContent = data.marketClosedReason || 'é€±æœ«/å‡æ—¥ä¸åŸ·è¡Œäº¤æ˜“ç¨‹åº';
            } else {
                marketNotice.style.display = 'none';
            }
            
            if (data.trades && data.trades.length > 0) {
                const tradesHtml = data.trades.slice(-10).reverse().map(t => {
                    const action = t.action || 'UNKNOWN';
                    let typeClass = action === 'BUY' ? 'buy' : (action === 'SELL' ? 'sell' : 'test');
                    let typeText = action === 'BUY' ? 'ğŸŸ¢ è²·å…¥' : (action === 'SELL' ? 'ğŸ”´ è³£å‡º' : 'ğŸ§ª ' + action);
                    return '<div class="trade-item ' + typeClass + '"><div class="trade-info"><div class="type">' + typeText + '</div><div class="date">' + new Date(t.date).toLocaleString('zh-TW') + '</div></div><div class="trade-details"><div class="price">$' + t.price.toFixed(2) + ' Ã— ' + t.shares + '</div>' + (t.reason ? '<div style="color:#888;font-size:0.8rem;">' + t.reason + '</div>' : '') + '</div></div>';
                }).join('');
                document.getElementById('tradesList').innerHTML = tradesHtml;
            }
        }
        loadData();
    </script>
</body>
</html>
